<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Курс евро — Лабораторная работа 7</title>
    <link rel="stylesheet" href="../main.css">
    <link rel="shortcut icon" href="../lab3/favicon.ico">
    <link rel="icon" href="../lab3/favicon-32x32.png">
    <link rel="icon" href="../lab3/favicon-16x16.png">
    <script>
        function getEuroExchangeRate() {
            const url = 'https://www.cbr-xml-daily.ru/daily_json.js';
            fetch(url)
                .then(function(response) {
                    return response.json();
                })
                .then(function(json) {
                    let current = json.Valute.EUR.Value;
                    let previous = json.Valute.EUR.Previous;

                    // Получение дат
                    let requestDate = new Date(json.Timestamp).toLocaleString();
                    let prevDate = new Date(json.PreviousDate).toLocaleDateString();

                    // Вычисление разницы
                    let diff = (current - previous).toFixed(4);
                    let diffColor = diff > 0 ? 'green' : diff < 0 ? 'red' : 'black';
                    let diffSign = diff > 0 ? '+' : '';
                    let changeText = diff > 0 ? 'повысился' : diff < 0 ? 'понизился' : 'не изменился';

                    let detail = document.getElementById('euro-detail');
                    detail.innerHTML = `
                        <div style="border:5px solid darkred; padding:15px; margin-top:15px; border-radius:8px; font-size:16px; line-height:1.5; text-align:left;background-color:rgb(241, 169, 46);">
                            <p><b>Дата запроса:</b> ${requestDate}</p>
                            <p><b>Курс евро (текущий):</b> ${current} ₽</p>
                            <p><b>Курс евро (${prevDate}):</b> ${previous} ₽</p>
                            <p><b>Изменение:</b> <span style="color:${diffColor};">${diffSign}${diff} ₽</span> — курс ${changeText}.</p>
                        </div>
                    `;
                })
        }
    </script>
</head>
<body>
    <header>
        НГТУ, ФБ, Лабораторная работа 7 — Курс евро
        <hr>
    </header>
    <main style="width:80%; margin:20px auto; text-align:center;">
        <button id="get-btn" onclick="getEuroExchangeRate()" style="padding:10px 20px; font-size:16px; font-weight:bold;">
            Получить курс евро
        </button>
        <div id="euro-detail"></div>
        <div style="margin-top:20px; font-size:14px;">
            <a href="https://www.cbr-xml-daily.ru/" target="_blank">Курсы ЦБ РФ в XML и JSON, API</a>
        </div>
    </main>
    <footer>
        <hr>
        &copy; Чинкевич Кирилл, ФБИ-32, 2 курс, 2025
    </footer>
</body>
</html>
