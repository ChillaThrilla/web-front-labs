<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Котировки акций компании Татнефть</title>
    <link rel="stylesheet" href="../main.css">
    <link rel="shortcut icon" href="../lab3/favicon.ico">
    <link rel="icon" href="../lab3/favicon-32x32.png">
    <link rel="icon" href="../lab3/favicon-16x16.png">
    <script src="quotes-data.js"></script>
    <script>

        function showQuotes() {
            const table = document.getElementById('quotes-table');
            table.style.width = '80%';
            // заголовок таблицы
            const headerRow = document.createElement('tr');
            const headers = ['Дата', 'Цена (₽)', 'Изменение'];
            for (let i = 0; i < headers.length; i++) {
                const th = document.createElement('th');
                th.innerText = headers[i];
                headerRow.appendChild(th);
            }
            table.appendChild(headerRow);

            // заполняем строки данными
            for (let i = 0; i < dates.length; i++) {
                const tr = document.createElement('tr');
                // дата
                let tdDate = document.createElement('td');
                tdDate.innerText = dates[i];
                tr.appendChild(tdDate);
                // цена
                let tdPrice = document.createElement('td');
                tdPrice.innerText = prices[i];
                tr.appendChild(tdPrice);
                // изменение
                let tdDiff = document.createElement('td');
                if (i === 0) {
                    tdDiff.innerText = '-';
                } else {
                    const rawDiff = prices[i] - prices[i - 1];
                    const formattedDiff = rawDiff.toFixed(2);
                    tdDiff.innerText = formattedDiff;
                    if (rawDiff > 0) tdDiff.style.color = 'green';
                    else if (rawDiff < 0) tdDiff.style.color = 'red';
                }
                tr.appendChild(tdDiff);
                table.appendChild(tr);
            }

            // вычисляем среднее, максимум и минимум
            let sum = 0;
            for (let i = 0; i < prices.length; i++) {
                sum += prices[i];
            }
            const avg = (sum / prices.length).toFixed(2);
            const max = Math.max(...prices);
            const min = Math.min(...prices);

            document.getElementById('detail').innerHTML =
                `<p>Средняя цена: ${avg} ₽</p>` +
                `<p>Максимальная цена: ${max.toLocaleString()} ₽</p>` +
                `<p>Минимальная цена: ${min.toLocaleString()} ₽</p>`;

            // удаляем кнопку после одного клика
            document.getElementById('load-btn').remove();
        }
    </script>
</head>
<body>
    <header>
        НГТУ, ФБ, Лабораторная работа 7 — Котировки акций компании Татнефть
        <hr>
    </header>
    <main>
        <button id="load-btn" onclick="showQuotes()"
                style="padding:10px 20px; font-size:16px; font-weight:bold;">
            Курс акций Татнефть
        </button>
        <table border="1" id="quotes-table"></table>
        <div id="detail" style="margin-top:15px; font-weight:bold;"></div>
    </main>
    <footer>
        <hr>
        &copy; Чинкевич Кирилл, ФБИ-32, 2 курс, 2025
    </footer>
</body>
</html>
